{"version":3,"file":"author-color-picker.min.js","sources":["../src/element.js"],"sourcesContent":["class AuthorColorPickerElement extends AuthorBaseElement(HTMLElement) {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineProperties({\n      canvas: {\n        private: true,\n        readonly: true,\n        get: () => this.shadowRoot.querySelector('canvas')\n      },\n\n      context: {\n        private: true,\n        readonly: true,\n        get: () => this.PRIVATE.canvas.getContext('2d')\n      },\n\n      position: {\n        private: true,\n        default: {\n          x: 0,\n          y: 0\n        }\n      },\n\n      dimensions: {\n        private: true,\n        readonly: true,\n        get: () => this.PRIVATE.canvas.getBoundingClientRect()\n      },\n\n      initialWidth: {\n        private: true,\n        default: 236\n      },\n\n      initialHeight: {\n        private: true,\n        default: 118\n      },\n\n      currentColor: {\n        private: true,\n        default: {\n          r: 255,\n          g: 255,\n          b: 255\n        }\n      },\n\n      selectedColor: {\n        private: true,\n        default: {\n          r: 255,\n          g: 255,\n          b: 255\n        }\n      },\n\n      previousColor: {\n        private: true,\n        default: {\n          r: 255,\n          g: 255,\n          b: 255\n        }\n      }\n    })\n\n    this.UTIL.definePrivateMethods({\n      draw: (width = this.PRIVATE.dimensions.width, height = this.PRIVATE.dimensions.height) => {\n        let { canvas, context } = this.PRIVATE\n\n        canvas.width = width\n        canvas.height = height\n        context.clearRect(0, 0, width, height)\n\n        let gradient = {\n          x: context.createLinearGradient(0, 0, width, 0),\n          y: context.createLinearGradient(0, 0, 0, height)\n        }\n\n        gradient.x.addColorStop(0 / 6, 'red')\n        gradient.x.addColorStop(1 / 6, 'fuchsia')\n        gradient.x.addColorStop(2 / 6, 'blue')\n        gradient.x.addColorStop(3 / 6, 'aqua')\n        gradient.x.addColorStop(4 / 6, 'lime')\n        gradient.x.addColorStop(5 / 6, 'yellow')\n        gradient.x.addColorStop(6 / 6, 'red')\n\n        context.fillStyle = gradient.x\n\t\t\t\tcontext.fillRect(0, 0, width, height)\n\n        gradient.y.addColorStop(0 / 4, 'white')\n        gradient.y.addColorStop(2 / 4, 'rgba(255,255,255,0)')\n        gradient.y.addColorStop(2 / 4, 'rgba(0,0,0,0)')\n        gradient.y.addColorStop(4 / 4, 'black')\n\n\t\t\t\tcontext.fillStyle = gradient.y\n\t\t\t\tcontext.fillRect(0, 0, width, height)\n      },\n\n      generateColorObj: ({ r, g, b }) => {\n        let hsl = this.PRIVATE.RGBToHSL({ r, g, b })\n        let hue = hsl[0]\n        let saturation = hsl[1]\n        let lightness = hsl[2]\n\n        return {\n          red: r,\n          green: g,\n          blue: b,\n          hex: `#${this.PRIVATE.RGBToHex({ r, g, b })}`,\n          rgb: `rgb(${r},${g},${b})`,\n          hsl: `hsl(${hue},${saturation * 100}%, ${lightness * 100}%)`,\n          hue,\n          saturation,\n          lightness\n        }\n      },\n\n      unitToHex: unit => {\n        let hex = Number(unit).toString(16)\n\n        if (hex.length < 2) {\n          hex = `0${hex}`\n        }\n\n        return hex.toUpperCase()\n      },\n\n      RGBToHex: ({ r = 255, g = 255, b = 255 }) => {\n        let { unitToHex } = this.PRIVATE\n        return `${unitToHex(r)}${unitToHex(g)}${unitToHex(b)}`\n      },\n\n      RGBToHSL: ({ r, g, b }) => {\n        r /= 255, g /= 255, b /= 255\n\n      \tlet min = Math.min(r, g, b)\n      \tlet max = Math.max(r, g, b)\n      \tlet difference = max - min\n\n        let hue, saturation\n\n        switch (max) {\n          case min:\n            hue = 0\n            saturation = 0\n            break\n\n          case r:\n            hue = (g - b) / difference\n            break\n\n          case g:\n            hue = 2 + (b - r) / difference\n            break\n\n          case b:\n            hue = 4 + (r - g) / difference\n            break\n        }\n\n      \thue = Math.min(hue * 60, 360)\n\n      \tif (hue < 0) {\n      \t\thue += 360\n      \t}\n\n      \tlet lightness = (min + max) / 2\n\n      \tif (lightness <= 0.5) {\n      \t\tsaturation = difference / (max + min)\n      \t} else {\n      \t\tsaturation = difference / (2 - max - min)\n      \t}\n\n      \treturn [hue, saturation, lightness]\n      },\n\n      pointermoveHandler: evt => {\n        if (evt.buttons < 1) {\n          return\n        }\n\n        let { top, left, width, height } = this.PRIVATE.dimensions\n        let relative = this.PRIVATE.getRelativePosition(evt)\n\n        if (relative.x !== this.position.x.px || relative.y !== this.position.y.px) {\n          this.PRIVATE.currentColor = this.PRIVATE.getColor(relative)\n\n          this.PRIVATE.position = relative\n\n          this.emit('sample', {\n            color: this.PRIVATE.generateColorObj(this.PRIVATE.currentColor),\n            position: this.position\n          })\n\n          document.addEventListener('pointerup', this.PRIVATE.pointerupHandler)\n        }\n      },\n\n      getColor: ({ x, y }) => {\n        let { data } = this.PRIVATE.context.getImageData(x, y, 1, 1)\n\n        return {\n          r: data[0],\n          g: data[1],\n          b: data[2]\n        }\n      },\n\n      pointerupHandler: evt => {\n        let { currentColor, pointermoveHandler, pointerupHandler } = this.PRIVATE\n\n        this.PRIVATE.previousColor = this.PRIVATE.selectedColor\n        this.PRIVATE.selectedColor = currentColor\n\n        this.emit('change', {\n          previous: this.previousColor,\n          color: this.selectedColor,\n          position: this.position\n        })\n\n        document.removeEventListener('pointermove', pointermoveHandler)\n        document.removeEventListener('pointerup', pointerupHandler)\n      },\n\n      getRelativePosition: evt => {\n        let { top, left, width, height } = this.PRIVATE.dimensions\n\n        return {\n          x: Math.min(Math.max(evt.pageX - left, 0), width - .1),\n          y: Math.min(Math.max(evt.pageY - top, 0), height)\n        }\n      }\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => {\n        let { draw, initialWidth, initialHeight } = this.PRIVATE\n        draw(initialWidth, initialHeight)\n      },\n\n      rendered: () => {\n        this.UTIL.registerListener(window, 'resize', evt => this.PRIVATE.draw())\n      }\n    })\n\n    this.UTIL.registerListeners(this, {\n      pointerenter: evt => {\n        let { dimensions, draw, initialWidth, initialHeight } = this.PRIVATE\n\n        if (initialWidth !== dimensions.width || initialHeight !== dimensions.height) {\n          draw()\n        }\n      },\n\n      pointerdown: evt => {\n        this.PRIVATE.position = this.PRIVATE.getRelativePosition(evt)\n\n        let { position, getColor, pointermoveHandler } = this.PRIVATE\n\n        this.PRIVATE.previousColor = this.PRIVATE.selectedColor\n        this.PRIVATE.selectedColor = getColor(position)\n\n        this.emit('change', {\n          previous: this.previousColor,\n          color: this.selectedColor,\n          position: this.position\n        })\n\n        document.addEventListener('pointermove', pointermoveHandler)\n      }\n    })\n  }\n\n  get position () {\n    let { position, dimensions } = this.PRIVATE\n\n    return {\n      x: {\n        px: position.x,\n        percentage: this.UTIL.getPercentageDecimal(position.x, dimensions.width)\n      },\n\n      y: {\n        px: position.y,\n        percentage: this.UTIL.getPercentageDecimal(position.y, dimensions.height)\n      }\n    }\n  }\n\n  get previousColor () {\n    return this.PRIVATE.generateColorObj(this.PRIVATE.previousColor)\n  }\n\n  get selectedColor () {\n    return this.PRIVATE.generateColorObj(this.PRIVATE.selectedColor)\n  }\n}\n\ncustomElements.define('author-color-picker', AuthorColorPickerElement)\n\nexport default AuthorColorPickerElement\n"],"names":["AuthorColorPickerElement","AuthorBaseElement","HTMLElement","[object Object]","super","this","UTIL","defineProperties","canvas","private","readonly","get","shadowRoot","querySelector","context","PRIVATE","getContext","position","default","x","y","dimensions","getBoundingClientRect","initialWidth","initialHeight","currentColor","r","g","b","selectedColor","previousColor","definePrivateMethods","draw","width","height","clearRect","gradient","createLinearGradient","addColorStop","fillStyle","fillRect","generateColorObj","hsl","RGBToHSL","hue","saturation","lightness","red","green","blue","hex","RGBToHex","rgb","unitToHex","unit","Number","toString","length","toUpperCase","min","Math","max","difference","pointermoveHandler","evt","buttons","top","left","relative","getRelativePosition","px","getColor","emit","color","document","addEventListener","pointerupHandler","data","getImageData","previous","removeEventListener","pageX","pageY","registerListeners","connected","rendered","registerListener","window","pointerenter","pointerdown","percentage","getPercentageDecimal","customElements","define"],"mappings":"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"}