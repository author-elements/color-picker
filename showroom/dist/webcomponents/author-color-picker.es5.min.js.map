{"version":3,"file":"author-color-picker.es5.min.js","sources":["../src/element.js"],"sourcesContent":["class AuthorColorPickerElement extends AuthorBaseElement(HTMLElement) {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineProperties({\n      canvas: {\n        private: true,\n        readonly: true,\n        get: () => this.shadowRoot.querySelector('canvas')\n      },\n\n      context: {\n        private: true,\n        readonly: true,\n        get: () => this.PRIVATE.canvas.getContext('2d')\n      },\n\n      position: {\n        private: true,\n        default: {\n          x: 0,\n          y: 0\n        }\n      },\n\n      dimensions: {\n        private: true,\n        readonly: true,\n        get: () => this.PRIVATE.canvas.getBoundingClientRect()\n      },\n\n      initialWidth: {\n        private: true,\n        default: 0\n      },\n\n      initialheight: {\n        private: true,\n        default: 0\n      },\n\n      currentColor: {\n        private: true,\n        default: {\n          r: 255,\n          g: 255,\n          b: 255\n        }\n      },\n\n      selectedColor: {\n        private: true,\n        default: {\n          r: 255,\n          g: 255,\n          b: 255\n        }\n      },\n\n      previousColor: {\n        private: true,\n        default: {\n          r: 255,\n          g: 255,\n          b: 255\n        }\n      }\n    })\n\n    this.UTIL.definePrivateMethods({\n      draw: (width, height) => {\n        let { canvas, context } = this.PRIVATE\n\n        canvas.width = width\n        canvas.height = height\n        context.clearRect(0, 0, width, height)\n\n        let gradient = {\n          x: context.createLinearGradient(0, 0, width, 0),\n          y: context.createLinearGradient(0, 0, 0, height)\n        }\n\n        gradient.x.addColorStop(0 / 6, 'red')\n        gradient.x.addColorStop(1 / 6, 'fuchsia')\n        gradient.x.addColorStop(2 / 6, 'blue')\n        gradient.x.addColorStop(3 / 6, 'aqua')\n        gradient.x.addColorStop(4 / 6, 'lime')\n        gradient.x.addColorStop(5 / 6, 'yellow')\n        gradient.x.addColorStop(6 / 6, 'red')\n\n        context.fillStyle = gradient.x\n\t\t\t\tcontext.fillRect(0, 0, width, height)\n\n        gradient.y.addColorStop(0 / 4, 'white')\n        gradient.y.addColorStop(2 / 4, 'rgba(255,255,255,0)')\n        gradient.y.addColorStop(2 / 4, 'rgba(0,0,0,0)')\n        gradient.y.addColorStop(4 / 4, 'black')\n\n\t\t\t\tcontext.fillStyle = gradient.y\n\t\t\t\tcontext.fillRect(0, 0, width, height)\n      },\n\n      generateColorObj: ({ r, g, b }) => {\n        let hsl = this.PRIVATE.RGBToHSL({ r, g, b })\n        let hue = hsl[0]\n        let saturation = hsl[1]\n        let lightness = hsl[2]\n\n        return {\n          red: r,\n          green: g,\n          blue: b,\n          hex: `#${this.PRIVATE.RGBToHex({ r, g, b })}`,\n          rgb: `rgb(${r},${g},${b})`,\n          hsl: `hsl(${hue},${saturation * 100}%, ${lightness * 100}%)`,\n          hue,\n          saturation,\n          lightness\n        }\n      },\n\n      unitToHex: unit => {\n        let hex = Number(unit).toString(16)\n\n        if (hex.length < 2) {\n          hex = `0${hex}`\n        }\n\n        return hex.toUpperCase()\n      },\n\n      RGBToHex: ({ r = 255, g = 255, b = 255 }) => {\n        let { unitToHex } = this.PRIVATE\n        return `${unitToHex(r)}${unitToHex(g)}${unitToHex(b)}`\n      },\n\n      RGBToHSL: ({ r, g, b }) => {\n        r /= 255, g /= 255, b /= 255\n\n      \tlet min = Math.min(r, g, b)\n      \tlet max = Math.max(r, g, b)\n      \tlet difference = max - min\n\n        let hue, saturation\n\n        switch (max) {\n          case min:\n            hue = 0\n            saturation = 0\n            break\n\n          case r:\n            hue = (g - b) / difference\n            break\n\n          case g:\n            hue = 2 + (b - r) / difference\n            break\n\n          case b:\n            hue = 4 + (r - g) / difference\n            break\n        }\n\n      \thue = Math.min(hue * 60, 360)\n\n      \tif (hue < 0) {\n      \t\thue += 360\n      \t}\n\n      \tlet lightness = (min + max) / 2\n\n      \tif (lightness <= 0.5) {\n      \t\tsaturation = difference / (max + min)\n      \t} else {\n      \t\tsaturation = difference / (2 - max - min)\n      \t}\n\n      \treturn [hue, saturation, lightness]\n      },\n\n      pointermoveHandler: evt => {\n        if (evt.buttons < 1) {\n          return\n        }\n\n        let { top, left, width, height } = this.PRIVATE.dimensions\n        let relative = this.PRIVATE.getRelativePosition(evt)\n\n        if (relative.x !== this.position.x.px || relative.y !== this.position.y.px) {\n          this.PRIVATE.currentColor = this.PRIVATE.getColor(relative)\n\n          this.PRIVATE.position = relative\n\n          this.emit('sample', {\n            color: this.PRIVATE.generateColorObj(this.PRIVATE.currentColor),\n            position: this.position\n          })\n\n          document.addEventListener('pointerup', this.PRIVATE.pointerupHandler)\n        }\n      },\n\n      getColor: ({ x, y }) => {\n        let { data } = this.PRIVATE.context.getImageData(x, y, 1, 1)\n\n        return {\n          r: data[0],\n          g: data[1],\n          b: data[2]\n        }\n      },\n\n      pointerupHandler: evt => {\n        let { currentColor, pointermoveHandler, pointerupHandler } = this.PRIVATE\n\n        this.PRIVATE.previousColor = this.PRIVATE.selectedColor\n        this.PRIVATE.selectedColor = currentColor\n\n        this.emit('change', {\n          previous: this.previousColor,\n          color: this.selectedColor,\n          position: this.position\n        })\n\n        document.removeEventListener('pointermove', pointermoveHandler)\n        document.removeEventListener('pointerup', pointerupHandler)\n      },\n\n      getRelativePosition: evt => {\n        let { top, left, width, height } = this.PRIVATE.dimensions\n\n        return {\n          x: Math.min(Math.max(evt.pageX - left, 0), width - .1),\n          y: Math.min(Math.max(evt.pageY - top, 0), height)\n        }\n      }\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => {\n        let { dimensions, draw } = this.PRIVATE\n\n        this.PRIVATE.initialWidth = dimensions.width\n        this.PRIVATE.initialHeight = dimensions.height\n\n        draw(dimensions.width, dimensions.height)\n      }\n    })\n\n    this.UTIL.registerListeners(this, {\n      pointerenter: evt => {\n        let { dimensions, draw, initialWidth, initialHeight } = this.PRIVATE\n\n        if (initialWidth !== dimensions.width || initialHeight !== dimensions.height) {\n          draw(dimensions.width, dimensions.height)\n        }\n      },\n\n      pointerdown: evt => {\n        this.PRIVATE.position = this.PRIVATE.getRelativePosition(evt)\n\n        let { position, getColor, pointermoveHandler } = this.PRIVATE\n\n        this.PRIVATE.previousColor = this.PRIVATE.selectedColor\n        this.PRIVATE.selectedColor = getColor(position)\n\n        this.emit('change', {\n          previous: this.previousColor,\n          color: this.selectedColor,\n          position: this.position\n        })\n\n        document.addEventListener('pointermove', pointermoveHandler)\n      }\n    })\n  }\n\n  get position () {\n    let { position, dimensions } = this.PRIVATE\n\n    return {\n      x: {\n        px: position.x,\n        percentage: this.UTIL.getPercentageDecimal(position.x, dimensions.width)\n      },\n\n      y: {\n        px: position.y,\n        percentage: this.UTIL.getPercentageDecimal(position.y, dimensions.height)\n      }\n    }\n  }\n\n  get previousColor () {\n    return this.PRIVATE.generateColorObj(this.PRIVATE.previousColor)\n  }\n\n  get selectedColor () {\n    return this.PRIVATE.generateColorObj(this.PRIVATE.selectedColor)\n  }\n}\n\ncustomElements.define('author-color-picker', AuthorColorPickerElement)\n\nexport default AuthorColorPickerElement\n"],"names":["AuthorColorPickerElement","UTIL","defineProperties","canvas","private","readonly","get","_this","shadowRoot","querySelector","context","PRIVATE","getContext","position","default","x","y","dimensions","getBoundingClientRect","initialWidth","initialheight","currentColor","r","g","b","selectedColor","previousColor","definePrivateMethods","draw","width","height","clearRect","gradient","createLinearGradient","addColorStop","fillStyle","fillRect","generateColorObj","hsl","RGBToHSL","hue","saturation","lightness","red","green","blue","hex","RGBToHex","rgb","unitToHex","unit","Number","toString","length","toUpperCase","min","Math","max","difference","pointermoveHandler","evt","buttons","relative","top","left","getRelativePosition","px","getColor","emit","color","document","addEventListener","pointerupHandler","data","getImageData","previous","removeEventListener","pageX","pageY","registerListeners","connected","initialHeight","pointerenter","pointerdown","AuthorBaseElement","HTMLElement","this","percentage","getPercentageDecimal","customElements","define"],"mappings":"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"}